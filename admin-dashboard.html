<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Admin Dashboard - INTELLECT DIGITAL WORLD</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="img/favicon.ico" rel="icon">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --sidebar-width: 280px;
            --sidebar-collapsed-width: 70px;
        }
        
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Sidebar Styles */
        .admin-sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }
        
        .admin-sidebar.collapsed {
            width: var(--sidebar-collapsed-width);
        }
        
        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .sidebar-logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            text-decoration: none;
        }
        
        .sidebar-toggle {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background 0.3s ease;
        }
        
        .sidebar-toggle:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .sidebar-menu {
            padding: 20px 0;
            list-style: none;
            margin: 0;
        }
        
        .menu-item {
            margin: 5px 15px;
        }
        
        .menu-link {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .menu-link:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            transform: translateX(5px);
        }
        
        .menu-link.active {
            background: rgba(255,255,255,0.2);
            color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .menu-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .menu-text {
            font-weight: 500;
            transition: opacity 0.3s ease;
        }
        
        .admin-sidebar.collapsed .menu-text {
            opacity: 0;
            width: 0;
        }
        
        .admin-sidebar.collapsed .menu-icon {
            margin-right: 0;
        }
        
        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            transition: margin-left 0.3s ease;
            min-height: 100vh;
            background: #f8f9fa;
        }
        
        .main-content.sidebar-collapsed {
            margin-left: var(--sidebar-collapsed-width);
        }
        
        .content-header {
            background: white;
            padding: 20px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-bottom: 1px solid #e9ecef;
        }
        
        .content-body {
            padding: 30px;
        }
        
        /* Dashboard Cards */
        .dashboard-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: none;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }
        
        .card-header-custom {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-radius: 12px 12px 0 0 !important;
            padding: 20px;
            border: none;
        }
        
        .metric-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: none;
            transition: all 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }
        
        .metric-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            margin-bottom: 15px;
        }
        
        .metric-icon.users { background: linear-gradient(45deg, #667eea, #764ba2); }
        .metric-icon.services { background: linear-gradient(45deg, #f093fb, #f5576c); }
        .metric-icon.courses { background: linear-gradient(45deg, #4facfe, #00f2fe); }
        .metric-icon.enrollments { background: linear-gradient(45deg, #43e97b, #38f9d7); }
        
        .metric-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .metric-label {
            color: #6c757d;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        /* Status Badges */
        .status-badge {
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-pending { background: #fff3cd; color: #614700; }
        .status-approved { background: #d1e7dd; color: #0f5132; }
        .status-rejected { background: #f8d7da; color: #842029; }
        .status-published { background: #d1e7dd; color: #0f5132; }
        .status-draft { background: #e2e3e5; color: #495057; }
        
        /* Responsive */
        @media (max-width: 768px) {
            .admin-sidebar {
                transform: translateX(-100%);
            }
            
            .admin-sidebar.show {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .mobile-menu-btn {
                display: block !important;
            }
        }
        
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px;
            font-size: 1.2rem;
        }
        
        /* Content Sections */
        .content-section {
            display: none !important;
        }
        
        .content-section.active {
            display: block !important;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Form Styles */
        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.2rem rgba(248, 15, 15, 0.25);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(248, 15, 15, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745, #20c997);
            border: none;
            border-radius: 8px;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #e83e8c);
            border: none;
            border-radius: 8px;
        }
        .admin-navbar, .navbar, .bg-primary {
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%) !important;
            color: #fff;
        }
    </style>
</head>
<body>
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Admin Sidebar -->
    <nav class="admin-sidebar" id="adminSidebar">
        <div class="sidebar-header">
            <a href="#" class="sidebar-logo" id="sidebarLogo">IDW Admin</a>
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        
        <ul class="sidebar-menu">
            <li class="menu-item">
                <a href="#" class="menu-link active" data-section="dashboard">
                    <div class="menu-icon"><i class="fas fa-tachometer-alt"></i></div>
                    <span class="menu-text">Dashboard</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#" class="menu-link" data-section="users">
                    <div class="menu-icon"><i class="fas fa-users"></i></div>
                    <span class="menu-text">Students</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#" class="menu-link" data-section="services">
                    <div class="menu-icon"><i class="fas fa-cogs"></i></div>
                    <span class="menu-text">Services</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#" class="menu-link" data-section="masterclass">
                    <div class="menu-icon"><i class="fas fa-chalkboard-teacher"></i></div>
                    <span class="menu-text">Masterclass</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#" class="menu-link" data-section="courses">
                    <div class="menu-icon"><i class="fas fa-graduation-cap"></i></div>
                    <span class="menu-text">Courses</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#" class="menu-link" data-section="enrollments">
                    <div class="menu-icon"><i class="fas fa-user-graduate"></i></div>
                    <span class="menu-text">Enrollments</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#" class="menu-link" data-section="announcements">
                    <div class="menu-icon"><i class="fas fa-bullhorn"></i></div>
                    <span class="menu-text">Announcements</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#" class="menu-link" data-section="settings">
                    <div class="menu-icon"><i class="fas fa-cog"></i></div>
                    <span class="menu-text">Settings</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="index.html" class="menu-link" data-action="admin-logout">
                    <div class="menu-icon"><i class="fas fa-sign-out-alt"></i></div>
                    <span class="menu-text">Logout</span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Dashboard Section -->
        <div class="content-section active" id="dashboard-section">
            <div class="content-header">
                <h2 class="mb-0">Dashboard Overview</h2>
                <p class="text-muted mb-0">Welcome to your admin control panel</p>
            </div>
            <div class="content-body">
                <!-- Metrics Cards -->
                <div class="row g-4 mb-4">
                    <div class="col-lg-3 col-md-6">
                        <div class="metric-card">
                            <div class="card-body text-center">
                                <div class="metric-icon users">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="metric-number" id="usersCount">0</div>
                                <div class="metric-label">Total Students</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <div class="metric-card">
                            <div class="card-body text-center">
                                <div class="metric-icon services">
                                    <i class="fas fa-cogs"></i>
                                </div>
                                <div class="metric-number" id="servicesCount">0</div>
                                <div class="metric-label">Service Applications</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <div class="metric-card">
                            <div class="card-body text-center">
                                <div class="metric-icon courses">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="metric-number" id="coursesCount">0</div>
                                <div class="metric-label">Total Courses</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <div class="metric-card">
                            <div class="card-body text-center">
                                <div class="metric-icon enrollments">
                                    <i class="fas fa-user-graduate"></i>
                                </div>
                                <div class="metric-number" id="enrollmentsCount">0</div>
                                <div class="metric-label">Total Enrollments</div>
                            </div>
                        </div>
                    </div>
        </div>

                <!-- Quick Actions -->
                <div class="row g-4">
                    <div class="col-lg-6">
                        <div class="dashboard-card">
                            <div class="card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>Recent Activity</h5>
                            </div>
                            <div class="card-body">
                                <div id="recentActivity">
                                    <div class="text-center text-muted py-4">
                                        <i class="fas fa-clock fa-2x mb-3"></i>
                                        <p>No recent activity</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="dashboard-card">
                            <div class="card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-tasks me-2"></i>Quick Actions</h5>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="showSection('courses')">
                                        <i class="fas fa-plus me-2"></i>Add New Course
                                    </button>
                                    <button class="btn btn-success" onclick="showSection('announcements')">
                                        <i class="fas fa-bullhorn me-2"></i>Post Announcement
                                    </button>
                                    <button class="btn btn-info" onclick="showSection('users')">
                                        <i class="fas fa-users me-2"></i>Manage Students
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Dashboard Widgets Row -->
                <div class="row g-4 mt-1">
                    <!-- Latest Announcements Widget -->
                    <div class="col-lg-6">
                        <div class="dashboard-card">
                            <div class="card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-bullhorn me-2"></i>Latest Announcements</h5>
                            </div>
                            <div class="card-body">
                                <ul id="latestAnnouncementsList" class="list-group list-group-flush mb-3"></ul>
                                <div class="mb-2">
                                    <textarea id="dashboardAnnouncementText" class="form-control" rows="2" placeholder="Write a quick announcement..."></textarea>
                                </div>
                                <button id="dashboardPostAnnouncementBtn" class="btn btn-primary w-100">
                                    <i class="fas fa-paper-plane me-2"></i>Post Announcement
                                </button>
                            </div>
            </div>
        </div>

                    <!-- Quick Add Service Application Widget -->
                    <div class="col-lg-6">
                        <div class="dashboard-card">
                            <div class="card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>Quick Add Service Application</h5>
                            </div>
                            <div class="card-body">
                                <form id="quickServiceForm" autocomplete="off">
                                    <div class="row g-2">
                                        <div class="col-md-6">
                                            <input id="qsName" class="form-control" placeholder="Client name" required>
                                        </div>
                                        <div class="col-md-6">
                                            <input id="qsEmail" type="email" class="form-control" placeholder="Email" required>
                                        </div>
                                        <div class="col-12">
                                            <input id="qsService" class="form-control" placeholder="Service e.g. Web Development" required>
                                        </div>
                                        <div class="col-12">
                                            <textarea id="qsMessage" rows="2" class="form-control" placeholder="Short note (optional)"></textarea>
                                        </div>
                                    </div>
                                    <div class="d-grid mt-3">
                                        <button id="quickAddServiceBtn" type="submit" class="btn btn-success">
                                            <i class="fas fa-plus me-2"></i>Add Application
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Enroll Student Widget -->
                    <div class="col-lg-6">
                        <div class="dashboard-card">
                            <div class="card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-user-graduate me-2"></i>Quick Enroll Student</h5>
                            </div>
                            <div class="card-body">
                                <form id="quickEnrollForm">
                                    <div class="row g-2">
                                        <div class="col-md-6">
                                            <select id="qeUser" class="form-select" required>
                                                <option value="">Select student</option>
                                            </select>
                                            <form id="qeAddStudentForm" class="mt-2">
                                                <div class="input-group input-group-sm">
                                                    <input id="qeNewStudentName" class="form-control" placeholder="New student name">
                                                    <input id="qeNewStudentEmail" type="email" class="form-control" placeholder="Email">
                                                    <button class="btn btn-outline-secondary" type="submit" title="Add student">Add</button>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="col-md-6">
                                            <select id="qeCourse" class="form-select" required>
                                                <option value="">Select course</option>
                                            </select>
                                            <form id="qeAddCourseForm" class="mt-2">
                                                <div class="input-group input-group-sm">
                                                    <input id="qeNewCourseTitle" class="form-control" placeholder="New course title">
                                                    <button class="btn btn-outline-secondary" type="submit" title="Add course">Add</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                    <div class="d-grid mt-3">
                                        <button type="submit" class="btn btn-secondary">
                                            <i class="fas fa-plus me-2"></i>Enroll
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Students Section -->
        <div class="content-section" id="users-section">
            <div class="content-header">
                <h2 class="mb-0">Student Management</h2>
                <p class="text-muted mb-0">Manage registered students and their accounts</p>
            </div>
            <div class="content-body">
                <div class="dashboard-card">
                    <div class="card-header-custom">
                        <div class="d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="fas fa-users me-2"></i>All Students</h5>
                            <div class="d-flex gap-2">
                                <input id="userSearch" class="form-control form-control-sm" placeholder="Search students..." style="max-width: 200px;">
                                <button id="sortUsersBtn" class="btn btn-sm btn-light">Sort by newest</button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Created</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Services Section -->
        <div class="content-section" id="services-section">
            <div class="content-header">
                <h2 class="mb-0">Service Applications</h2>
                <p class="text-muted mb-0">Review and manage service applications</p>
            </div>
            <div class="content-body">
                <div class="dashboard-card">
                    <div class="card-header-custom">
                        <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>Pending Applications</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Service</th>
                                        <th>Time</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="appsTbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Masterclass Applications Section -->
        <div class="content-section" id="masterclass-section">
            <div class="content-header">
                <h2 class="mb-0">Masterclass Applications</h2>
                <p class="text-muted mb-0">View and manage training/masterclass applications</p>
            </div>
            <div class="content-body">
                <div class="dashboard-card mb-4">
                    <div class="card-header-custom">
                        <div class="d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="fas fa-chalkboard me-2"></i>Manage Masterclass Courses</h5>
                            <button class="btn btn-sm btn-primary" id="addMcCourseBtn"><i class="fas fa-plus me-1"></i> Add Course</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <form class="mb-3 d-none" id="mcCourseForm">
                            <div class="row g-2 align-items-end">
                                <div class="col-md-3">
                                    <label class="form-label mb-1">Title</label>
                                    <input id="mcTitle" class="form-control" required>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label mb-1">Level</label>
                                    <input id="mcLevel" class="form-control" placeholder="Beginner" required>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label mb-1">Duration</label>
                                    <input id="mcDuration" class="form-control" placeholder="6 Weeks" required>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label mb-1">Price</label>
                                    <input id="mcPrice" class="form-control" placeholder="$199">
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label mb-1">Outline (comma separated)</label>
                                    <input id="mcOutline" class="form-control" required>
                                </div>
                                <div class="col-auto">
                                    <button type="submit" class="btn btn-success" id="mcSaveBtn">Save</button>
                                    <button type="button" class="btn btn-secondary" id="mcCancelBtn">Cancel</button>
                                </div>
                            </div>
                            <input type="hidden" id="mcEditIndex">
                        </form>
                        <div class="table-responsive">
                            <table class="table table-sm align-middle">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Level</th>
                                        <th>Duration</th>
                                        <th>Price</th>
                                        <th>Outline</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="mcCoursesTbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header-custom">
                        <h5 class="mb-0"><i class="fas fa-file-alt me-2"></i>Masterclass Applications</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Course</th>
                                        <th>Schedule</th>
                                        <th>Applied</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="mcAppsTbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Courses Section -->
        <div class="content-section" id="courses-section">
            <div class="content-header">
                <h2 class="mb-0">Course Management</h2>
                <p class="text-muted mb-0">Create, edit, and manage courses</p>
            </div>
            <div class="content-body">
                <div class="dashboard-card">
                    <div class="card-header-custom">
                        <div class="d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="fas fa-graduation-cap me-2"></i>All Courses</h5>
                            <button id="createCourseBtn" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#courseModal">
                                <i class="fas fa-plus me-2"></i>Add Course
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Category</th>
                                        <th>Level</th>
                                        <th>Created</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="coursesTbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enrollments Section -->
        <div class="content-section" id="enrollments-section">
            <div class="content-header">
                <h2 class="mb-0">Course Enrollments</h2>
                <p class="text-muted mb-0">View all student enrollments</p>
            </div>
            <div class="content-body">
                <div class="dashboard-card">
                    <div class="card-header-custom">
                        <h5 class="mb-0"><i class="fas fa-user-graduate me-2"></i>Enrollment Records</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Student</th>
                                        <th>Email</th>
                                        <th>Course</th>
                                        <th>Enrolled</th>
                                    </tr>
                                </thead>
                                <tbody id="enrollmentsTbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Announcements Section -->
        <div class="content-section" id="announcements-section">
            <div class="content-header">
                <h2 class="mb-0">Announcements</h2>
                <p class="text-muted mb-0">Create and manage site announcements</p>
            </div>
            <div class="content-body">
                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="dashboard-card">
                            <div class="card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-bullhorn me-2"></i>All Announcements</h5>
                            </div>
                            <div class="card-body">
                                <ul id="announcementsList" class="list-group list-group-flush"></ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="dashboard-card">
                            <div class="card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-plus me-2"></i>Create New</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Announcement</label>
                                    <textarea id="announcementText" class="form-control" rows="4" placeholder="Write your announcement..."></textarea>
                                </div>
                                <button id="postAnnouncementBtn" class="btn btn-primary w-100">
                                    <i class="fas fa-paper-plane me-2"></i>Post Announcement
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="content-section" id="settings-section">
            <div class="content-header">
                <h2 class="mb-0">Site Settings</h2>
                <p class="text-muted mb-0">Configure site preferences and branding</p>
            </div>
            <div class="content-body">
                <div class="row g-4">
                    <div class="col-lg-6">
                        <div class="dashboard-card">
                            <div class="card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-palette me-2"></i>Brand Settings</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Brand Preview</label>
                                    <div class="d-flex gap-2 align-items-center">
                                        <span class="badge" style="background: var(--primary);">Primary</span>
                                        <span class="badge" style="background: var(--secondary);">Secondary</span>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Site Title</label>
                                    <input id="siteTitleInput" class="form-control" placeholder="INTELLECT DIGITAL WORLD">
                                </div>
                                <button id="saveSettingsBtn" class="btn btn-primary">
                                    <i class="fas fa-save me-2"></i>Save Settings
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="dashboard-card">
                            <div class="card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>System Info</h5>
                            </div>
            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-6">
                                        <div class="text-center">
                                            <div class="metric-number text-primary" id="totalUsers">0</div>
                                            <div class="metric-label">Students</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="text-center">
                                            <div class="metric-number text-success" id="totalCourses">0</div>
                                            <div class="metric-label">Courses</div>
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <div class="text-muted small">
                                    <p><strong>Version:</strong> 1.0.0</p>
                                    <p><strong>Last Updated:</strong> <span id="lastUpdated"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/auth.js"></script>
    <script>
    (function() {
        // Gate: admin only
        if (localStorage.getItem('adminAuthToken') !== 'idh-admin-2025') {
            window.location.href = 'admin-login.html';
            return;
        }

        // Sidebar functionality
        const sidebar = document.getElementById('adminSidebar');
        const mainContent = document.getElementById('mainContent');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');

        // Toggle sidebar
        sidebarToggle.addEventListener('click', function() {
            sidebar.classList.toggle('collapsed');
            mainContent.classList.toggle('sidebar-collapsed');
        });

        // Mobile menu toggle
        mobileMenuBtn.addEventListener('click', function() {
            sidebar.classList.toggle('show');
        });

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(e) {
            if (window.innerWidth <= 768 && 
                !sidebar.contains(e.target) && 
                !mobileMenuBtn.contains(e.target)) {
                sidebar.classList.remove('show');
            }
        });

        // Section switching
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            // Update active menu link - query fresh to avoid stale references
            document.querySelectorAll('.menu-link[data-section]').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-section') === sectionName) {
                    link.classList.add('active');
                }
            });
            
            // Close mobile menu
            sidebar.classList.remove('show');
        }

        // Make showSection globally available
        window.showSection = showSection;

        // Data management functions
        function getUsers() {
            try { return JSON.parse(localStorage.getItem('users') || '[]'); } catch (_) { return []; }
        }
        function setUsers(users) { localStorage.setItem('users', JSON.stringify(users)); }
        function getServiceApps() {
            try { return JSON.parse(localStorage.getItem('serviceApplications') || '[]'); } catch (_) { return []; }
        }
        function setServiceApps(apps) { localStorage.setItem('serviceApplications', JSON.stringify(apps)); }
        function getCourses() {
            try { return JSON.parse(localStorage.getItem('courses') || '[]'); } catch (_) { return []; }
        }
        function setCourses(courses) { localStorage.setItem('courses', JSON.stringify(courses)); }
        function getAnnouncements() { try { return JSON.parse(localStorage.getItem('announcements') || '[]'); } catch (_) { return []; } }
        function setAnnouncements(items) { localStorage.setItem('announcements', JSON.stringify(items)); }
        function getSettings() { try { return JSON.parse(localStorage.getItem('siteSettings') || '{}'); } catch (_) { return {}; } }
        function setSettings(s) { localStorage.setItem('siteSettings', JSON.stringify(s)); }
        function getMasterclassApps(){ try { return JSON.parse(localStorage.getItem('masterclassApplications')||'[]'); } catch(_) { return []; } }
        function setMasterclassApps(v){ localStorage.setItem('masterclassApplications', JSON.stringify(v)); }
        function getMasterclassCourses(){ try { return JSON.parse(localStorage.getItem('masterclassCourses')||'[]'); } catch(_) { return []; } }
        function setMasterclassCourses(v){ localStorage.setItem('masterclassCourses', JSON.stringify(v)); }

        // Aggregate enrollments across all users
        function getAllEnrollments() {
            const users = getUsers();
            const result = [];
            users.forEach(u => {
                const key = 'enrollments:' + u.id;
                try {
                    const arr = JSON.parse(localStorage.getItem(key) || '[]');
                    arr.forEach(e => result.push({ userId: u.id, userEmail: u.email, userName: u.name, courseId: e.id, title: e.title, enrolledDate: e.enrolledDate }));
                } catch (_) {}
            });
            return result;
        }

        function render() {
            const users = getUsers();
            const apps = getServiceApps();
            const courses = getCourses();
            const enrollments = getAllEnrollments();
            const mcApps = getMasterclassApps();
            const mcCourses = getMasterclassCourses();
            
            // Update metric counts
            document.getElementById('usersCount').textContent = users.length;
            document.getElementById('servicesCount').textContent = apps.length;
            document.getElementById('coursesCount').textContent = courses.length;
            document.getElementById('enrollmentsCount').textContent = enrollments.length;
            document.getElementById('totalUsers').textContent = users.length;
            document.getElementById('totalCourses').textContent = courses.length;
            document.getElementById('lastUpdated').textContent = new Date().toLocaleString();

            // Users table
            const ut = document.getElementById('usersTbody');
            const query = (document.getElementById('userSearch')?.value || '').toLowerCase();
            const filteredUsers = users.filter(u => (u.name||'').toLowerCase().includes(query) || (u.email||'').toLowerCase().includes(query));
            ut.innerHTML = filteredUsers.map(u => `
                <tr>
                    <td>${u.name || ''}</td>
                    <td>${u.email}</td>
                    <td>${new Date(u.createdAt).toLocaleString()}</td>
                    <td><button class="btn btn-sm btn-outline-danger" data-remove-user="${u.id}">Remove</button></td>
                </tr>`).join('');

            // Service applications table
            const at = document.getElementById('appsTbody');
            at.innerHTML = apps.map((a,i) => `
                <tr>
                    <td>${a.name}</td>
                    <td>${a.email}</td>
                    <td>${a.service}</td>
                    <td>${a.timestamp}</td>
                    <td><span class="status-badge ${a.status==='approved'?'status-approved':a.status==='rejected'?'status-rejected':'status-pending'}">${a.status||'pending'}</span></td>
                    <td class="text-end">
                        <div class="btn-group btn-group-sm" role="group">
                            <button class="btn btn-success" data-approve-app="${i}">Approve</button>
                            <button class="btn btn-outline-danger" data-reject-app="${i}">Reject</button>
                        </div>
                    </td>
                </tr>`).join('');

            // Masterclass applications table
            const mct = document.getElementById('mcAppsTbody');
            if (mct){
                mct.innerHTML = mcApps.map((a,i)=>`
                    <tr>
                        <td>${a.name}</td>
                        <td>${a.email}</td>
                        <td>${a.courseTitle}</td>
                        <td>${a.schedule||''}</td>
                        <td>${new Date(a.createdAt).toLocaleString()}</td>
                        <td class="text-end">
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-danger" data-remove-mcapp="${i}">Remove</button>
                            </div>
                        </td>
                    </tr>
                `).join('');
            }

            // Masterclass Courses table
            const mcCoursesTbody = document.getElementById('mcCoursesTbody');
            if (mcCoursesTbody) {
                mcCoursesTbody.innerHTML = mcCourses.map((c,i)=>`
                    <tr>
                        <td>${c.title}</td><td>${c.level||''}</td><td>${c.duration||''}</td><td>${c.price||''}</td><td>${(c.outline||[]).join('<br>')}</td>
                        <td class="text-end">
                            <button class="btn btn-outline-primary btn-sm" data-edit-mccourse="${i}">Edit</button>
                            <button class="btn btn-outline-danger btn-sm" data-remove-mccourse="${i}">Delete</button>
                        </td>
                    </tr>
                `).join('');
            }

            // Courses table
            const ct = document.getElementById('coursesTbody');
            ct.innerHTML = courses.map((c,i)=>`
                <tr>
                    <td>${c.title}</td>
                    <td>${c.category||''}</td>
                    <td>${c.level||''}</td>
                    <td>${c.createdAt?new Date(c.createdAt).toLocaleString():''}</td>
                    <td><span class="status-badge ${c.published?'status-published':'status-draft'}">${c.published?'Published':'Draft'}</span></td>
                    <td class="text-end">
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-secondary" data-edit-course="${i}">Edit</button>
                            <button class="btn btn-outline-danger" data-remove-course="${i}">Delete</button>
                            <button class="btn btn-success" data-toggle-publish="${i}">${c.published?'Unpublish':'Publish'}</button>
                        </div>
                    </td>
                </tr>`).join('');

            // Enrollments table
            const et = document.getElementById('enrollmentsTbody');
            et.innerHTML = enrollments.map(e => `
                <tr>
                    <td>${e.userName || ''}</td>
                    <td>${e.userEmail}</td>
                    <td>${e.title}</td>
                    <td>${new Date(e.enrolledDate).toLocaleString()}</td>
                </tr>`).join('');

            // Announcements list
            const annList = document.getElementById('announcementsList');
            const anns = getAnnouncements();
            // Full announcements page list
            if (annList) annList.innerHTML = anns.map((a,i)=>`
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <strong>${new Date(a.createdAt).toLocaleString()}</strong>
                        <div>${a.text}</div>
                    </div>
                    <button class="btn btn-sm btn-outline-danger" data-remove-ann="${i}">Remove</button>
                </li>`).join('');

            // Dashboard latest announcements (top 5)
            const latestList = document.getElementById('latestAnnouncementsList');
            if (latestList) {
                const latest = anns.slice(0, 5);
                latestList.innerHTML = latest.length ? latest.map(a=>`
                    <li class="list-group-item">
                        <div class="small text-muted">${new Date(a.createdAt).toLocaleString()}</div>
                        <div>${a.text}</div>
                    </li>
                `).join('') : `
                    <li class="list-group-item text-muted text-center">No announcements yet</li>
                `;
            }

            // Settings
            const settings = getSettings();
            if (settings.siteTitle) { 
                document.getElementById('siteTitleInput').value = settings.siteTitle; 
            }

            // Populate quick enroll dropdowns
            const qeUserSel = document.getElementById('qeUser');
            const qeCourseSel = document.getElementById('qeCourse');
            if (qeUserSel && qeCourseSel) {
                const userOptions = ['<option value="">Select student</option>']
                    .concat(users.map(u => {
                        const label = (u.name && u.name.trim()) ? `${u.name} (${u.email})` : u.email;
                        return `<option value="${u.id}">${label}</option>`;
                    }));
                const courseOptions = ['<option value="">Select course</option>']
                    .concat(courses.map((c, i) => `<option value="${c.title}">${c.title}</option>`));
                qeUserSel.innerHTML = userOptions.join('');
                qeCourseSel.innerHTML = courseOptions.join('');
            }
        }

        // Event listeners
        // Live sync: re-render when data changes in other tabs/windows
        window.addEventListener('storage', function(e){
            const keysToWatch = ['users','serviceApplications','courses','announcements','siteSettings','masterclassApplications','masterclassCourses'];
            if (keysToWatch.includes(e.key)) {
                try { render(); } catch (_) {}
            }
        });
        // Refresh when tab becomes visible again
        document.addEventListener('visibilitychange', function(){
            if (!document.hidden) { try { render(); } catch (_) {} }
        });
        document.addEventListener('click', function(e) {
            // Handle menu navigation
            const menuLink = e.target.closest('.menu-link[data-section]');
            if (menuLink) {
                e.preventDefault();
                const section = menuLink.getAttribute('data-section');
                if (section) {
                    showSection(section);
                    return;
                }
            }
            
            const rmUserBtn = e.target.closest('[data-remove-user]');
            if (rmUserBtn) {
                const id = Number(rmUserBtn.getAttribute('data-remove-user'));
                const users = getUsers().filter(u => u.id !== id);
                setUsers(users);
                render();
            }
            
            const rmCourseBtn = e.target.closest('[data-remove-course]');
            if (rmCourseBtn) {
                const idx = Number(rmCourseBtn.getAttribute('data-remove-course'));
                const courses = getCourses();
                courses.splice(idx, 1);
                setCourses(courses);
                render();
            }
            
            const editCourseBtn = e.target.closest('[data-edit-course]');
            if (editCourseBtn) {
                const idx = Number(editCourseBtn.getAttribute('data-edit-course'));
                openCourseModal(idx);
            }
            
            const togglePublishBtn = e.target.closest('[data-toggle-publish]');
            if (togglePublishBtn) {
                const idx = Number(togglePublishBtn.getAttribute('data-toggle-publish'));
                const courses = getCourses();
                courses[idx].published = !courses[idx].published;
                setCourses(courses);
                render();
            }
            
            const approveBtn = e.target.closest('[data-approve-app]');
            if (approveBtn) {
                const idx = Number(approveBtn.getAttribute('data-approve-app'));
                const apps = getServiceApps();
                apps[idx].status = 'approved';
                setServiceApps(apps);
                render();
            }
            
            const rejectBtn = e.target.closest('[data-reject-app]');
            if (rejectBtn) {
                const idx = Number(rejectBtn.getAttribute('data-reject-app'));
                const apps = getServiceApps();
                apps[idx].status = 'rejected';
                setServiceApps(apps);
                render();
            }

            const rmMcBtn = e.target.closest('[data-remove-mcapp]');
            if (rmMcBtn){
                const idx = Number(rmMcBtn.getAttribute('data-remove-mcapp'));
                const apps = getMasterclassApps();
                apps.splice(idx,1);
                setMasterclassApps(apps);
                render();
            }
            
            const rmAnnBtn = e.target.closest('[data-remove-ann]');
            if (rmAnnBtn) {
                const idx = Number(rmAnnBtn.getAttribute('data-remove-ann'));
                const anns = getAnnouncements();
                anns.splice(idx,1);
                setAnnouncements(anns);
                render();
            }

            const editMcCourseBtn = e.target.closest('[data-edit-mccourse]');
            if (editMcCourseBtn) {
                const idx = Number(editMcCourseBtn.getAttribute('data-edit-mccourse'));
                const c = getMasterclassCourses()[idx];
                document.getElementById('mcTitle').value = c.title;
                document.getElementById('mcLevel').value = c.level||'';
                document.getElementById('mcDuration').value = c.duration||'';
                document.getElementById('mcPrice').value = c.price||'';
                document.getElementById('mcOutline').value = (c.outline||[]).join(', ');
                document.getElementById('mcEditIndex').value = idx;
                document.getElementById('mcCourseForm').classList.remove('d-none');
            }

            const rmMcCourseBtn = e.target.closest('[data-remove-mccourse]');
            if (rmMcCourseBtn) {
                const idx = Number(rmMcCourseBtn.getAttribute('data-remove-mccourse'));
                let courses = getMasterclassCourses();
                courses.splice(idx,1); setMasterclassCourses(courses); renderMasterclassCourses();
            }
        });

        // Form handlers
        document.getElementById('userSearch').addEventListener('input', render);
        document.getElementById('sortUsersBtn').addEventListener('click', function(){
            const users = getUsers().sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt));
            setUsers(users); 
            render();
        });

        document.getElementById('postAnnouncementBtn').addEventListener('click', function(){
            const el = document.getElementById('announcementText');
            const txt = el.value.trim();
            if(!txt) return; 
            const items = getAnnouncements();
            items.unshift({ text: txt, createdAt: new Date().toISOString() });
            setAnnouncements(items); 
            el.value=''; 
            render();
        });

        // Dashboard quick announcement
        document.getElementById('dashboardPostAnnouncementBtn').addEventListener('click', function(){
            const el = document.getElementById('dashboardAnnouncementText');
            const txt = el.value.trim();
            if(!txt) return; 
            const items = getAnnouncements();
            items.unshift({ text: txt, createdAt: new Date().toISOString() });
            setAnnouncements(items); 
            el.value=''; 
            render();
        });

        document.getElementById('saveSettingsBtn').addEventListener('click', function(){
            const title = document.getElementById('siteTitleInput').value.trim();
            const cur = getSettings(); 
            setSettings({ ...cur, siteTitle: title || 'INTELLECT DIGITAL WORLD' });
            alert('Settings saved');
        });

        const exportBtn = document.getElementById('exportMcAppsBtn');
        if (exportBtn){
            exportBtn.addEventListener('click', function(){
                const items = getMasterclassApps();
                if (!items.length) { alert('No applications to export.'); return; }
                let csv = 'Name,Email,Course,Schedule,Applied\n';
                items.forEach(a=>{
                    const row = [a.name,a.email,a.courseTitle,a.schedule||'',new Date(a.createdAt).toLocaleString()].map(v=>`"${(v||'').toString().replace(/"/g,'""')}"`).join(',');
                    csv += row + '\n';
                });
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url; a.download = 'masterclass-applications.csv'; document.body.appendChild(a); a.click(); document.body.removeChild(a); window.URL.revokeObjectURL(url);
            });
        }

        // Course modal helpers
        function openCourseModal(index){
            const modal = document.getElementById('courseModal');
            const form = document.getElementById('courseForm');
            const titleEl = document.getElementById('courseTitleInput');
            const catEl = document.getElementById('courseCategoryInput');
            const levelEl = document.getElementById('courseLevelInput');
            const pubEl = document.getElementById('coursePublishedInput');
            form.setAttribute('data-edit-index', index!=null ? index : '');
            if(index!=null){
                const c = getCourses()[index];
                titleEl.value = c.title||''; 
                catEl.value=c.category||''; 
                levelEl.value=c.level||''; 
                pubEl.checked=!!c.published;
            } else { 
                titleEl.value=''; 
                catEl.value=''; 
                levelEl.value=''; 
                pubEl.checked=true; 
            }
            new bootstrap.Modal(modal).show();
        }

        document.getElementById('createCourseBtn').addEventListener('click', function(){ 
            openCourseModal(null); 
        });
        
        document.addEventListener('submit', function(e){
            const form = e.target.closest('#courseForm');
            if (!form) return;
            e.preventDefault();
            const title = document.getElementById('courseTitleInput').value.trim();
            const category = document.getElementById('courseCategoryInput').value.trim();
            const level = document.getElementById('courseLevelInput').value.trim();
            const published = document.getElementById('coursePublishedInput').checked;
            if(!title) return; 
            const courses = getCourses();
            const idxAttr = form.getAttribute('data-edit-index');
            const payload = { title, category, level, published, createdAt: new Date().toISOString() };
            if(idxAttr!==''){
                const idx = Number(idxAttr); 
                const orig=courses[idx]; 
                courses[idx] = { ...orig, ...payload, createdAt: orig.createdAt||payload.createdAt }; 
            } else { 
                courses.unshift(payload); 
            }
            setCourses(courses);
            const modalEl = document.getElementById('courseModal');
            const inst = bootstrap.Modal.getInstance(modalEl) || new bootstrap.Modal(modalEl);
            inst.hide();
            render();
        });

        // Quick add service application from dashboard
        document.getElementById('quickServiceForm').addEventListener('submit', function(e){
            e.preventDefault();
            const name = document.getElementById('qsName').value.trim();
            const email = document.getElementById('qsEmail').value.trim();
            const service = document.getElementById('qsService').value.trim();
            const message = document.getElementById('qsMessage').value.trim();
            if (!name || !email || !service) return;
            const apps = getServiceApps();
            apps.unshift({
                name,
                email,
                phone: '',
                service,
                message,
                timestamp: new Date().toLocaleString(),
                status: 'new',
                priority: 'medium',
                id: Date.now()
            });
            setServiceApps(apps);
            // reset form
            document.getElementById('quickServiceForm').reset();
            render();
        });

        // Quick enroll student from dashboard
        document.getElementById('quickEnrollForm').addEventListener('submit', function(e){
            e.preventDefault();
            const userId = Number(document.getElementById('qeUser').value);
            const courseId = document.getElementById('qeCourse').value;
            if (!userId || !courseId) return;
            const users = getUsers();
            const user = users.find(u => u.id === userId);
            const course = getCourses().find(c => c.title === courseId);
            if (!user || !course) return;
            const key = 'enrollments:' + user.id;
            let arr = [];
            try { arr = JSON.parse(localStorage.getItem(key) || '[]'); } catch (_) { arr = []; }
            // avoid duplicate by title
            if (!arr.some(e => e.id === course.title)) {
                arr.unshift({ id: course.title, title: course.title, enrolledDate: new Date().toISOString() });
                localStorage.setItem(key, JSON.stringify(arr));
            }
            (document.getElementById('quickEnrollForm')).reset();
            render();
        });

        // Add new student (quick)
        document.getElementById('qeAddStudentForm').addEventListener('submit', function(e){
            e.preventDefault();
            const name = document.getElementById('qeNewStudentName').value.trim();
            const email = document.getElementById('qeNewStudentEmail').value.trim().toLowerCase();
            if (!name || !email || !/[^\s@]+@[^\s@]+\.[^\s@]+/.test(email)) return;
            const users = getUsers();
            if (users.some(u => (u.email||'').toLowerCase() === email)) {
                document.getElementById('qeNewStudentEmail').focus();
                return;
            }
            const newUser = { id: Date.now(), name, email, password: '', createdAt: new Date().toISOString(), avatar: '', bio: '', phone: '', dateOfBirth: '', country: '' };
            users.push(newUser);
            setUsers(users);
            document.getElementById('qeAddStudentForm').reset();
            render();
        });

        // Add new course (quick)
        document.getElementById('qeAddCourseForm').addEventListener('submit', function(e){
            e.preventDefault();
            const title = document.getElementById('qeNewCourseTitle').value.trim();
            if (!title) return;
            const courses = getCourses();
            if (courses.some(c => (c.title||'').toLowerCase() === title.toLowerCase())) {
                document.getElementById('qeNewCourseTitle').focus();
                return;
            }
            courses.unshift({ title, category: '', level: '', published: false, createdAt: new Date().toISOString() });
            setCourses(courses);
            document.getElementById('qeAddCourseForm').reset();
            render();
        });

        // Initial render
        render();

        // Masterclass Courses: Add/Edit Handlers
        // Show add form on button click
        document.getElementById('addMcCourseBtn').addEventListener('click', function() {
            document.getElementById('mcCourseForm').reset();
            document.getElementById('mcEditIndex').value = '';
            document.getElementById('mcCourseForm').classList.remove('d-none');
        });
        // Hide form on cancel
        document.getElementById('mcCancelBtn').addEventListener('click', function() {
            document.getElementById('mcCourseForm').classList.add('d-none');
        });
        // Handle form submit (add and edit)
        document.getElementById('mcCourseForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const title = document.getElementById('mcTitle').value.trim();
            const level = document.getElementById('mcLevel').value.trim();
            const duration = document.getElementById('mcDuration').value.trim();
            const price = document.getElementById('mcPrice').value.trim();
            const outline = document.getElementById('mcOutline').value.split(',').map(s=>s.trim()).filter(s=>s);
            const idx = document.getElementById('mcEditIndex').value;
            if (!title || !level || !duration) return;
            let mcCourses = getMasterclassCourses();
            const payload = { id: Date.now().toString(), title, level, duration, price, outline };
            if(idx !== '') {
                mcCourses[idx] = { ...mcCourses[idx], ...payload };
            } else {
                mcCourses.unshift(payload);
            }
            setMasterclassCourses(mcCourses);
            document.getElementById('mcCourseForm').classList.add('d-none');
            render();
        });
    })();
    </script>

    <!-- Course Modal -->
    <div class="modal fade" id="courseModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Course</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="courseForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">Title</label>
                            <input id="courseTitleInput" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Category</label>
                            <input id="courseCategoryInput" class="form-control" placeholder="e.g. Web Development">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Level</label>
                            <select id="courseLevelInput" class="form-select">
                                <option value="">Select level</option>
                                <option>Beginner</option>
                                <option>Intermediate</option>
                                <option>Advanced</option>
                            </select>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="coursePublishedInput">
                            <label class="form-check-label" for="coursePublishedInput">Published</label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>
</html>



